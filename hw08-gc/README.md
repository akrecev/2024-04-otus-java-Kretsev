# Задание 4

### Определение нужного размера хипа
<br/>
Цель работы - оптимизация работы сборщика мусора в JVM
<br/>
Замеры скорости работы приложения CalcDemo
- G1GC <br/>

| Количество памяти, МБ | время работы, мсек |
|-----------------------|--------------------|
| 256                   | 11606              |
| 512                   | 8897               |
| 1024                  | 8460               |
| 1152                  | 8321               |
| 1280                  | 8362               |
| 1408                  | 8627               |
| 2048                  | 8427               |

Увеличение размера хипа выше 1152 МБ не имеет смысла при использовании G1GC <br/>
<br/>

- ParallelGC <br/>

| Количество памяти, МБ | время работы, мсек |
|-----------------------|--------------------|
| 1024                  | 23002              |
| 2048                  | 17125              |
| 4096                  | 7010               |
| 8192                  | 2913               |
| 10240                 | 2766               |
| 10752                 | 2782               |
| 11264                 | error              |

Увеличение размера хипа выше 10752 МБ не имеет смысла при использовании ParallelGC <br/>
<br/>

- ShenandoahGC <br/>

| Количество памяти, МБ | время работы, мсек |
|-----------------------|--------------------|
| 256                   | error              |
| 512                   | 15698              |
| 1024                  | 5838               |
| 2048                  | 3348               |
| 4096                  | 3359               |
| 8192                  | 3703               |
| 10240                 | 3062               |
| 10752                 | error              |

При использовании ShenandoahGC наилучшее время работы обеспечивается использованием максимального объема памяти  <br/>
<br/>

- SerialGC <br/>

| Количество памяти, МБ | время работы, мсек |
|-----------------------|--------------------|
| 256                   | error              |
| 512                   | 9384               |
| 1024                  | 6497               |
| 2048                  | 5120               |
| 4096                  | 3751               |
| 8192                  | 3259               |
| 10240                 | 2854               |
| 10752                 | 3021               |
| 12288                 | error              |

При использовании SerialGC наилучшее время работы обеспечивается использованием максимального объема памяти  <br/>
<br/>

- ZGC (Experimental) <br/>

| Количество памяти, МБ | время работы, мсек |
|-----------------------|--------------------|
| 256                   | error              |
| 512                   | 8703               |
| 1024                  | 4182               |
| 2048                  | 3239               |
| 4096                  | 3193               |
| 8192                  | 3590               |
| 10240                 | 3653               |
| 12288                 | error              |

Увеличение размера хипа выше 10752 МБ не имеет смысла при использовании ZGC

<br/> Лучшее время выполнения приложения показало использование ParallelGC с использованием максимального объема памяти для heap - 2,8 с при 10 ГБ

<br/> Наименее требователен к объему памяти - G1GC - 8,3 с при 1 ГБ выделенной оперативной памяти

<br/> После простой оптимизации - замена обертки Integer на примитив int:

|              | Количество памяти, МБ | до оптимизации | после оптимизации |
|--------------|-----------------------|----------------|-------------------|
| G1GC         | 1152                  | 8321           | 1242              |
| ParallelGC   | 10240                 | 2766           | 870               |
| ShenandoahGC | 10240                 | 3062           | 893               |
| SerialGC     | 10240                 | 2854           | 891               |
| ZGC          | 4096                  | 3193           | 827               |

<br/> Таким образом, решающее значение на время работы имеет оптимизация работы приложения.